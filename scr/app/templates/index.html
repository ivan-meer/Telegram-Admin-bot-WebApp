<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="/scr/app/static/css/styles.css">
</head>

<script>
    //–∫–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥
    const tg = window.Telegram.WebApp;
    tg.BackButton.show();

    tg.BackButton.onClick(() => {
        tg.expand(); // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ expand() —Å—Ä–∞–±–æ—Ç–∞–µ—Ç
        setTimeout(() => {
            window.history.back();
        }, 0);
    });
</script>

<body>
<div class="container">
    <h1>‚öôÔ∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
    <!-- –≠—Ç–æ –±—ã–ª –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç -->
    <div id="usercard" class="user-info"></div>

    <a href="/formation-groups" class="btn">üë• –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø</a>
    <a href="/restrictions_on_messages" class="btn">üë§ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</a>
    <a href="/restrictions_messages" class="btn">‚úâÔ∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è</a>
    <a href="/channel_subscription_limit" class="btn">üì¢ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –ø–æ–¥–ø–∏—Å–∫–µ –Ω–∞ –∫–∞–Ω–∞–ª</a>
    <a href="/filter_words" class="btn">üö´ –§–∏–ª—å—Ç—Ä –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤</a>
    <a href="/grant_user_special_rights_group" class="btn">üîí –í—ã–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—Å–æ–±—ã–µ –ø—Ä–∞–≤–∞ –≤ –≥—Ä—É–ø–ø–µ</a>
    <a href="/add_groups_for_tracking" class="btn">üîç –î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø—ã / –∫–∞–Ω–∞–ª—ã –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è</a>
    <a href="/help" class="btn">‚ùì –ü–æ–º–æ—â—å –ø–æ —Ä–∞–±–æ—Ç–µ —Å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é</a>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <script>
        // –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ Telegram –Ω–∞ —ç–∫—Ä–∞–Ω
        document.addEventListener('DOMContentLoaded', () => {
            const tg = window.Telegram?.WebApp;
            if (!tg) {
                console.error('–≠—Ç–æ –Ω–µ WebApp Telegram');
                return;
            }

            tg.expand();
            tg.BackButton.show();
            tg.BackButton.onClick(() => {
                tg.expand();
                setTimeout(() => window.history.back(), 0);
            });

            console.log('initDataUnsafe:', tg.initDataUnsafe);

            const user = tg.initDataUnsafe?.user || {};
            const card = document.getElementById('usercard');

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–æ–ª–µ–π
            console.log('user object:', user);

            // === –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ ===
            const greeting = document.createElement('h2');
            const userName = user.first_name || user.username || '–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            greeting.innerText = `üëã –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, ${userName}!`;
            card.appendChild(greeting); // –í—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

            // const parts = [];
            // if (user.first_name) parts.push(user.first_name);
            // if (user.last_name) parts.push(user.last_name);
            // if (user.username) parts.push(`@${user.username}`);
            //
            //
            // const profPara = document.createElement('p');
            // profPara.innerText = parts.length
            //     ? parts.join(' ') + (user.language_code ? ` (${user.language_code})` : '')
            //     : '–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
            // card.appendChild(profPara);
            //
            // const idPara = document.createElement('p');
            // idPara.innerText = `ID: ${user.id ?? '–Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω'}`;
            // card.appendChild(idPara);
        });
    </script>

</div>

<script src="/scr/app/static/js/admin.js"></script>
</body>

</html>